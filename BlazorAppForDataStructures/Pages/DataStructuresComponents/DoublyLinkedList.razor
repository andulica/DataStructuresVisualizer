@page "/doublyLinkedList"
@using DataStructuresVisualizer.DataStructures.DoublyLinkedListFile
@using BlazorAppForDataStructures.Pages.DataStructuresComponents
@inject IJSRuntime JSRuntime

<h3>Doubly Linked List Operations</h3>

<div class="operation-selection">
    <select @bind="selectedAction">
        <option value="insertAtPosition">Insert At Position</option>
        <option value="prepend">Prepend</option>
        <option value="append">Append</option>
        <option value="search">Search</option>
        <option value="remove">Remove</option>
        <option value="create">Create</option>
    </select>
    @switch (selectedAction)
    {
        case "insertAtPosition":
            <div class="insertion-fields">
                <label>Input Value:</label>
                <input type="number" @bind="inputValue" placeholder="Enter Value" />
                <label>Insert Position:</label>
                <input type="number" @bind="insertPosition" placeholder="Enter Position" />
                <button class="custom-button" @onclick="PerformInsertion" disabled="@isOperationInProgress">Insert</button>
            </div>
            break;
        case "prepend":
            <div class="insertion-fields">
                <label>Input Value:</label>
                <input type="number" @bind="inputValue" placeholder="Enter Value" />
                <button class="custom-button" @onclick="PrependValue" disabled="@isOperationInProgress">Prepend</button>
            </div>
            break;
        case "append":
            <div class="insertion-fields">
                <label>Input Value:</label>
                <input type="number" @bind="inputValue" placeholder="Enter Value" />
                <button class="custom-button" @onclick="AppendValue" disabled="@isOperationInProgress">Append</button>
            </div>
            break;
        case "search":
            <div class="insertion-fields">
                <label>Input Value:</label>
                <input type="number" @bind="inputValue" placeholder="Enter Value" />
                <button class="custom-button" @onclick="SearchValue" disabled="@isOperationInProgress">Search</button>
            </div>
            break;
        case "remove":
            <div class="insertion-fields">
                <label>Input Value:</label>
                <input type="number" @bind="inputValue" placeholder="Enter Value" />
                <button class="custom-button" @onclick="RemoveValue" disabled="@isOperationInProgress">Remove</button>
            </div>
            break;
        case "create":
            <div class="create-fields">
                <label>Input Value:</label>
                <input type="number" @bind="inputValue" placeholder="Enter Value" />
                <button class="custom-button" @onclick="CreateDoublyLinkedList" disabled="@isOperationInProgress">Create List</button>
            </div>
            break;
        default:
            break;
    }
</div>

<div class="linked-list">
    @if (doublyLinkedList.Head != null)
    {
        <DoublyLinkedListNodeComponent NodeValue="@doublyLinkedList.Head._data" NextNode="@doublyLinkedList.Head.Next" PrevNode="@doublyLinkedList.Head.Prev" />
        var currentNode = doublyLinkedList.Head.Next;
        while (currentNode != null)
        {
            <DoublyLinkedListNodeComponent NodeValue="currentNode._data" NextNode="currentNode.Next" PrevNode="currentNode.Prev" />
            currentNode = currentNode.Next;
        }
    }
</div>

@code {
    private string selectedAction = "create";
    private int inputValue;
    private int insertPosition;
    private bool isOperationInProgress = false;

    private DoublyLinkedList<int> doublyLinkedList = new DoublyLinkedList<int>();

    private async Task PerformInsertion()
    {
        isOperationInProgress = true;
        try
        {
            await Task.Delay(500); // Simulate delay
            doublyLinkedList.InsertAt(inputValue, insertPosition);
            StateHasChanged();
        }
        catch (Exception ex)
        {
            // Handle exception
        }
        finally
        {
            isOperationInProgress = false;
        }
    }

    private async Task PrependValue()
    {
        isOperationInProgress = true;
        try
        {
            await Task.Delay(500); // Simulate delay
            doublyLinkedList.Prepend(inputValue);
            StateHasChanged();
        }
        catch (Exception ex)
        {
            // Handle exception
        }
        finally
        {
            isOperationInProgress = false;
        }
    }

    private async Task AppendValue()
    {
        isOperationInProgress = true;
        try
        {
            await Task.Delay(500); // Simulate delay
            doublyLinkedList.Append(inputValue);
            StateHasChanged();
        }
        catch (Exception ex)
        {
            // Handle exception
        }
        finally
        {
            isOperationInProgress = false;
        }
    }

    private async Task SearchValue()
    {
        isOperationInProgress = true;
        try
        {
            await Task.Delay(500); // Simulate delay
            // Implement search logic
        }
        catch (Exception ex)
        {
            // Handle exception
        }
        finally
        {
            isOperationInProgress = false;
        }
    }

    private async Task RemoveValue()
    {
        isOperationInProgress = true;
        try
        {
            await Task.Delay(500); // Simulate delay
            doublyLinkedList.Delete(inputValue);
            StateHasChanged();
        }
        catch (Exception ex)
        {
            // Handle exception
        }
        finally
        {
            isOperationInProgress = false;
        }
    }

    private async Task CreateDoublyLinkedList()
    {
        isOperationInProgress = true;
        try
        {
            await Task.Delay(500); // Simulate delay
            for (int i = 0; i < inputValue; i++)
            {
                doublyLinkedList.Append(i + 1); // Simulate appending nodes
            }
            StateHasChanged();
        }
        catch (Exception ex)
        {
            // Handle exception
        }
        finally
        {
            isOperationInProgress = false;
        }
    }
}